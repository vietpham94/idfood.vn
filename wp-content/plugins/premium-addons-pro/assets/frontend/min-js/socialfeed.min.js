"function"!=typeof Object.create&&(Object.create=function(t){function e(){}return e.prototype=t,new e}),function(f,n){f.fn.socialfeed=function(t){var u=f.extend({plugin_folder:"",template:"template.html",show_media:!1,readMore:"Read More â†’",media_min_width:300,length:500,date_format:"ll",date_locale:"en",since:{years:" years ago",months:" months ago",weeks:" weeks ago",minutes:" minutes ago",seconds:" seconds ago"}},t),l=f(this),e=["facebook","twitter"],d=0,m=0;e.forEach(function(t){u[t]&&(u[t].accounts?d+=u[t].limit*u[t].accounts.length:u[t].urls?d+=u[t].limit*u[t].urls.length:d+=u[t].limit)});var c={request:function(t,e){f.ajax({url:t,dataType:"jsonp",success:e})},get_request:function(t,e){f.get(t,e,"json")},wrapLinks:function(t,e){return t.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,c.wrapLinkTemplate)},wrapLinkTemplate:function(t){return'<a target="_blank" href="'+t+'">'+t+"</a>"},shorten:function(t){return(t=f.trim(t)).length>u.length?jQuery.trim(t).substring(0,u.length).split(" ").slice(0,-1).join(" ")+"...":t},stripHTML:function(t){return null==t?"":t.replace(/(<([^>]+)>)|nbsp;|\s{2,}|/gi,"")}};function a(t,e){this.content=e,this.content.social_network=t,this.content.attachment=this.content.attachment===n?"":this.content.attachment,this.content.time_ago=e.dt_create,this.content.dt_create=this.content.dt_create.valueOf(),this.content.text=c.wrapLinks(c.shorten(e.message+" "+e.description),e.social_network),this.content.moderation_passed=!u.moderation||u.moderation(this.content),h[t].posts.push(this)}var h={template:!(a.prototype={render:function(){var t=h.template(this.content),e=this.content;if(0!==f(l).children("[social-feed-id="+e.id+"]").length)return!1;if(0===f(l).children().length)f(l).append(t);else{var a=-1;if(this.content.social_network,f.each(f(l).children(),function(){}),f(l).append(t),0<=a){a++;var i=f(l).children("div:nth-child("+a+")"),n=f(l).children("div:last-child");f(n).insertBefore(i)}}if(u.media_min_width){var o="[social-feed-id="+e.id+"] img.attachment",r=f(o),s=new Image,c=r.attr("src");f(s).on("load",function(){s.width<u.media_min_width&&r.hide(),delete s}).on("error",function(){r.hide()}).attr({src:c})}++m==d&&u.callback&&u.callback()}}),init:function(){h.getTemplate(function(){e.forEach(function(e){u[e]&&(u[e].accounts?u[e].accounts.forEach(function(t){h[e].getData(t)}):u[e].urls?u[e].urls.forEach(function(t){h[e].getData(t)}):h[e].getData())})})},getTimeAgo:function(t,e){"fb"===e&&(t=t.replace(/-/g,"/").replace("T"," ").split("+")[0]);var a=Date.now()-new Date(t).getTime();return a<6e4?1<(a=Math.round(a/1e3))?a+" seconds ago":a+" second ago":a<36e5?1<(a=Math.round(a/6e4))?a+" minutes ago":a+" minute ago":a<864e5?1<(a=Math.round(a/36e5))?a+" hours ago":a+" hour ago":a<2592e6?1<(a=Math.round(a/864e5))?a+" days ago":a+" day ago":a<31536e6?1<(a=Math.round(a/2592e6))?a+u.since.months:a+" month ago":1<(a=Math.round(a/31536e6))?a+u.since.years:a+" year ago"},getTemplate:function(e){return h.template?e():u.template_html?(h.template=doT.template(u.template_html),e()):void f.get(u.template,function(t){return h.template=doT.template(t),e()})},twitter:{posts:[],loaded:!1,api:"https://api.tweecool.com/",getData:function(t){var e=new Codebird;switch(e.setToken(u.twitter.token,u.twitter.secret)||e.setConsumerKey(u.twitter.consumer_key,u.twitter.consumer_secret),u.twitter.proxy!==n&&e.setProxy(u.twitter.proxy),t[0]){case"@":var a=t.substr(1);e.__call("statuses_userTimeline",{id:a,count:u.twitter.limit,tweet_mode:void 0===u.twitter.tweet_mode?"compatibility":u.twitter.tweet_mode},h.twitter.utility.getPosts,!0);break;case"#":var i=t.substr(1);e.__call("search_tweets",{q:i,count:u.twitter.limit,tweet_mode:void 0===u.twitter.tweet_mode?"compatibility":u.twitter.tweet_mode},function(t){jQuery.ajax({url:h.twitter.utility.getPosts(t.statuses)}).done(function(){u.callback()})},!0)}},utility:{getPosts:function(t){t&&f.each(t,function(){new a("twitter",h.twitter.utility.unifyPostData(this)).render()})},unifyPostData:function(t){var e={};if(t.id&&(e.id=t.id_str,e.dt_create=h.getTimeAgo(t.created_at,"twitter"),e.author_link="https://twitter.com/"+t.user.screen_name,e.author_picture=t.user.profile_image_url_https,e.readMore=u.readMore,e.post_url=e.author_link+"/status/"+t.id_str,e.author_name=t.user.name,e.message=void 0===t.text?t.full_text.substr(t.display_text_range[0],t.display_text_range[1]):t.text,e.description="",e.link="https://twitter.com/"+t.user.screen_name+"/status/"+t.id_str,!0===u.show_media&&t.entities.media&&0<t.entities.media.length)){var a=t.entities.media[0].media_url_https;a&&(e.attachment='<img class="attachment" src="'+a+'" />')}return e}}},facebook:{posts:[],graph:"https://graph.facebook.com/",loaded:!1,getData:function(t){function e(t){c.request(t,h.facebook.utility.getPosts)}var a="?fields=id,from,message,created_time,story";a+=!0===u.show_media?",full_picture":"";var i,n="&limit="+u.facebook.limit,o="&access_token="+u.facebook.access_token+"&callback=?";switch(t[0]){case"@":var r=t.substr(1);h.facebook.utility.getUserId(r,function(t){""!==t.id&&(i=h.facebook.graph+"v4.0/"+t.id+"/posts"+a+n+o,e(i))&&console.log(i)});break;case"!":var s=t.substr(1);i=h.facebook.graph+"v4.0/"+s+"/feed"+a+n+o,e(i),console.log(i);break;default:e(i)}},utility:{getUserId:function(t,e){var a="https://graph.facebook.com/"+t+"?&access_token="+u.facebook.access_token+"&callback=?";f.get(a,e,"json")},prepareAttachment:function(t){var e=t.full_picture;return-1!==e.indexOf("_b.")||(-1!==e.indexOf("safe_image.php")?e=h.facebook.utility.getExternalImageURL(e,"url"):-1!==e.indexOf("app_full_proxy.php")?e=h.facebook.utility.getExternalImageURL(e,"src"):t.object_id&&(e=h.facebook.graph+t.object_id+"/picture/?type=normal")),'<img class="attachment" src="'+e+'" />'},getExternalImageURL:function(t,e){return-1===(t=decodeURIComponent(t).split(e+"=")[1]).indexOf("fbcdn-sphotos")?t.split("&")[0]:t},getPosts:function(t){t.data&&t.data.forEach(function(t){null!==t.from&&new a("facebook",h.facebook.utility.unifyPostData(t)).render()})},unifyPostData:function(t){var e={},a=t.message?t.message:t.story;if(e.id=t.id,e.dt_create=h.getTimeAgo(t.created_time,"fb"),e.author_link="http://facebook.com/"+t.from.id,e.author_picture=h.facebook.graph+t.from.id+"/picture",e.readMore=u.readMore,e.author_name=t.from.name,e.name=t.name||"",e.message=a||"",e.description=t.description?t.description:"",e.link=t.link?t.link:"http://facebook.com/"+t.id,!0===u.show_media&&t.full_picture){var i=h.facebook.utility.prepareAttachment(t);i&&(e.attachment=i)}return e}}}};return this.each(function(){h.init(),u.update_period&&setInterval(function(){return h.init()},u.update_period)})}}(jQuery);